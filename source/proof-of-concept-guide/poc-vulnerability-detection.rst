.. Copyright (C) 2015, Fortishield, Inc.

.. meta::
   :description: Fortishield detects if installed applications have an unpatched CVE in the monitored system. Learn more about this in this PoC.

Vulnerability detection
=======================

Fortishield uses the Vulnerability Detection module to identify vulnerabilities in applications and operating systems running on endpoints.

This use case shows how Fortishield detects unpatched Common Vulnerabilities and Exposures (CVEs) in the monitored endpoint.

For more information on this capability, check the :doc:`vulnerability detection </user-manual/capabilities/vulnerability-detection/index>` section of the documentation.

Infrastructure
--------------

+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Endpoint      | Description                                                                                                                                |
+===============+============================================================================================================================================+
| Ubuntu 22.04  | The vulnerability detection module checks for vulnerabilities in the operating system and installed applications in this Linux endpoint.   |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+
| Windows 11    | The vulnerability detection module checks for vulnerabilities in the operating system and installed applications in this Windows endpoint. |
+---------------+--------------------------------------------------------------------------------------------------------------------------------------------+

Configuration
-------------

The Vulnerability Detection module is enabled by default. You can perform the following steps on the Fortishield server to ensure that the Fortishield Vulnerability Detection module is enabled.

#. Open the ``/var/ossec/etc/ossec.conf`` file on the Fortishield server. Check the Vulnerability Detection module is enabled:

   .. code-block:: xml
      :emphasize-lines: 2
   
      <vulnerability-detection>
         <enabled>yes</enabled>
         <index-status>yes</index-status>
         <feed-update-interval>60m</feed-update-interval>
      </vulnerability-detection>
   
      <indexer>
         <enabled>yes</enabled>
         <hosts>
            <host>https://0.0.0.0:9200</host>
         </hosts>
         <ssl>
            <certificate_authorities>
            <ca>/etc/filebeat/certs/root-ca.pem</ca>
            </certificate_authorities>
            <certificate>/etc/filebeat/certs/filebeat.pem</certificate>
            <key>/etc/filebeat/certs/filebeat-key.pem</key>
         </ssl>
      </indexer>

#. If you made changes to the configuration, restart the Fortishield manager.

   .. code-block:: console

      $ sudo systemctl restart fortishield-manager

Visualize the alerts
--------------------

You can visualize the alert data in the Fortishield dashboard. To do this, go to the Vulnerability Detection module, select Events, and click on any vulnerability to expand the document.

.. thumbnail:: /images/poc/vulnerabilities-ubuntu-alerts.png
   :title: Detected vulnerabilities on Ubuntu alerts
   :align: center
   :width: 80%
